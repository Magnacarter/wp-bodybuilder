{"version":3,"sources":["admin-script.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"admin-app.js","sourcesContent":["jQuery( document ).ready( function($) {\n\n\t// Counter for day-repeater click function\n\tvar i            = 1,\n\t\tselect       = $( 'select.wpbb-exercise-selection' ),\n\t\tdayRepeatAdd = $( '.day-repeat-add' );\n\n\t// Set all variables to be used in scope\n\tvar frame,\n\t\tmetaBox      = $( '#exercise-custom-fields.postbox' ), // Your meta box id here\n\t\taddImgLink   = metaBox.find( '.upload-custom-img' ),\n\t\tdelImgLink   = metaBox.find( '.delete-custom-img' ),\n\t\timgContainer = metaBox.find( '.custom-img-container' ),\n\t\timgIdInput   = metaBox.find( '.custom-img-id' );\n\n\t// ADD IMAGE LINK\n\taddImgLink.on( 'click', function( event ){\n\n\t\tevent.preventDefault();\n\n\t\t// If the media frame already exists, reopen it.\n\t\tif ( frame ) {\n\t\t\tframe.open();\n\t\t\treturn;\n\t\t}\n\n\t\t// Create a new media frame\n\t\tframe = wp.media({\n\t\t\ttitle: 'Select or Upload Media for Exercise',\n\t\t\tbutton: {\n\t\t\t\ttext: 'Use this media'\n\t\t\t},\n\t\t\tmultiple: true  // Set to true to allow multiple files to be selected\n\t\t});\n\n\t\t// When an image is selected in the media frame...\n\t\tframe.on( 'select', function() {\n\n\t\t\t// Get media attachment details from the frame state\n\t\t\tvar attachment = frame.state().get('selection').first().toJSON();\n\n\t\t\t// Send the attachment URL to our custom image input field.\n\t\t\timgContainer.append( '<img src=\"'+attachment.url+'\" alt=\"\" style=\"max-width:150px;\"/>' );\n\n\t\t\t// Send the attachment id to our hidden input\n\t\t\timgIdInput.val( attachment.id );\n\n\t\t\t// Hide the add image link\n\t\t\taddImgLink.addClass( 'hidden' );\n\n\t\t\t// Unhide the remove image link\n\t\t\tdelImgLink.removeClass( 'hidden' );\n\t\t});\n\n\t\t// Finally, open the modal on click\n\t\tframe.open();\n\t});\n\n\n\t// DELETE IMAGE LINK\n\tdelImgLink.on( 'click', function( event ){\n\n\t\tevent.preventDefault();\n\n\t\t// Clear out the preview image\n\t\timgContainer.html( '' );\n\n\t\t// Un-hide the add image link\n\t\taddImgLink.removeClass( 'hidden' );\n\n\t\t// Hide the delete image link\n\t\tdelImgLink.addClass( 'hidden' );\n\n\t\t// Delete the image id from the hidden input\n\t\timgIdInput.val( '' );\n\n\t});\n\n\t/**\n\t * Add exercise\n\t */\n\tvar addExercise = function( selectedValue, list ) {\n\n\t\t$.ajax({\n\t\t\ttype: 'POST',\n\t\t\tdataType: 'json',\n\t\t\turl: ajaxurl,\n\t\t\tdata: {\n\t\t\t\taction: 'workout_process_ajax',\n\t\t\t\texerciseId: selectedValue\n\t\t\t},\n\t\t\tsuccess: function(response) {\n\n\t\t\t\tif (response.success === true) {\n\t\t\t\t\tvar json = response.data;\n\n\t\t\t\t\tif (json.post_title !== '') {\n\t\t\t\t\t\tlist.find('#exercise-list').append('<li class=\"list\" data-exercise-id=\"' + json.ID + '\">' +\n\t\t\t\t\t\t\t'<h4><strong>' + json.post_title + ' : </strong></h4>' +\n\t\t\t\t\t\t\t'<span>' +\n\t\t\t\t\t\t\t'<input type=\"text\" id=\"sets\" name=\"sets\" placeholder=\"Sets\" value=\"\"/>' +\n\t\t\t\t\t\t\t'<input type=\"text\" id=\"reps\" name=\"reps\" placeholder=\"Reps/Duration\" value=\"\"/>' +\n\t\t\t\t\t\t\t'<input type=\"text\" id=\"rest\" name=\"rest\" placeholder=\"Rest between sets\" value=\"\"/>' +\n\t\t\t\t\t\t\t'<a href=\"\" class=\"remove-exercise\">x</a>' +\n\t\t\t\t\t\t\t'</span>' +\n\t\t\t\t\t\t\t'</li>');\n\t\t\t\t\t}\n\n\t\t\t\t\t$(\".remove-exercise\").on('click', function (e) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tvar exerciseListItem = $(this).parent().parent();\n\t\t\t\t\t\texerciseListItem.remove();\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif ( response.success === false ) {\n\t\t\t\t\tconsole.log( 'not working' );\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t};\n\n\t/**\n\t * RenameDay\n\t *\n\t * Change the day names to the correct days when the user removes a day\n\t * in the admin screen\n\t *\n\t * @since 1.0.0\n\t * return void\n\t */\n\tconst renameDay = function() {\n\n\t\tvar d    = 1,\n\t\t\tdays = document.getElementsByClassName( 'day-exercises' );\n\n\t\tfor( var i = 0; i < days.length; i++ ) {\n\n\t\t\tvar day = days[i].getElementsByTagName('h3');\n\n\t\t\tvar dayTitle = day[0].innerHTML = \"Day \" + d;\n\n\t\t\td++;\n\t\t}\n\t};\n\n\t/**\n\t * Initialize select2 plugin\n\t */\n\tvar modifySelect = function() {\n\t\t$( 'select.wpbb-exercise-selection' ).select2();\n\t};\n\tmodifySelect();\n\n\t/**\n\t * Add day\n\t */\n\tconst addDay = function( bool ) {\n\n\t\t$.ajax({\n\t\t\ttype: 'POST',\n\t\t\tdataType: 'json',\n\t\t\turl: ajaxurl,\n\t\t\tdata: {\n\t\t\t\taction: 'add_day_ajax',\n\t\t\t\taddDay: bool\n\t\t\t},\n\t\t\tsuccess: function( response ) {\n\n\t\t\t\tif (response.success === true) {\n\n\t\t\t\t\tvar exercisePosts = response.data;\n\t\t\t\t\tvar dayRepeat     = $( '.day_repeat' );\n\n\t\t\t\t\tdayRepeat.append( '<li id=\"day-list-item\" class=\"day-exercises\"><div class=\"day-header\">' +\n\t\t\t\t\t\t'<span><h3>Day 1</h3></span>' +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t'<div><p>Add Exercises</p></div>' +\n\t\t\t\t\t\t'<select class=\"wpbb-exercise-selection\">' +\n\t\t\t\t\t\t'<option>Add Exercise</option>' );\n\n\t\t\t\t\tfor( var j = 0; exercisePosts.length > j; j++ ) {\n\n\t\t\t\t\t\t$( '.wpbb-exercise-selection' ).append( '<option value=\"' + exercisePosts[j].ID + '\">' + exercisePosts[j].post_title + '</option>' );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tdayRepeat.find( 'li' ).append( '</select>' +\n\n\t\t\t\t\t\t'<div class=\"selected-exercises\">You\\'ve added the following exercises:</div>' +\n\t\t\t\t\t\t'<div class=\"selected-exercises-wrap\"><ul id=\"exercise-list\"></ul></div>' +\n\t\t\t\t\t\t'<div id=\"remove-btn\">' +\n\t\t\t\t\t\t'<a class=\"day-repeat-remove button\" href=\"#\">Remove Day</a></div>' );\n\n\t\t\t\t\t\t// Add a new instance of select2 plugin for the new selectbox in the DOM\n\t\t\t\t\t\tmodifySelect();\n\n\t\t\t\t\tdayRepeat.append( '</li>' );\n\n\t\t\t\t}\n\n\t\t\t},\n\t\t\tcomplete: function() {\n\t\t\t\tremoveDay();\n\n\t\t\t\t$('.wpbb-exercise-selection').change( function () {\n\n\t\t\t\t\tvar selectedValue = $(this).val();\n\t\t\t\t\tvar list          = $(this).parent();\n\n\t\t\t\t\t// Reset the dropdown menu so you can select the same item twice without selecting another first\n\t\t\t\t\t$( this ).prop( 'selectedIndex', 0 );\n\n\t\t\t\t\taddExercise( selectedValue, list );\n\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t};\n\n\t/**\n\t * Remove day\n\t */\n\tconst removeDay = function() {\n\t\t$( '.day-repeat-remove' ).click( function( e ) {\n\t\t\te.preventDefault();\n\t\t\t$( this ).parent().parent().remove();\n\t\t\ti--;\n\t\t\trenameDay();\n\t\t\treturn false;\n\t\t});\n\t};\n\tremoveDay();\n\n\t/**\n\t * Remove exercise\n\t */\n\tconst removeExercise = function() {\n\t\t$(\".remove-exercise\").on('click', function (e) {\n\t\t\te.preventDefault();\n\t\t\tvar exerciseListItem = $(this).parent().parent();\n\t\t\texerciseListItem.remove();\n\t\t});\n\t};\n\tremoveExercise();\n\n\t// Add day on click\n\tdayRepeatAdd.click( function( e ) {\n\n\t\te.preventDefault();\n\t\ti++;\n\n\t\tif( ! $( '.day_repeat' ).has( '.wpbb-exercise-selection' ).length ) {\n\t\t\tvar bool = true;\n\t\t\taddDay( bool );\n\t\t}\n\n\t\tvar dayNumber = document.getElementsByClassName( 'day-exercises' ).length + 1;\n\n\t\tvar fieldSelect = $(this).closest('td').find( '.day_repeat li#day-list-item:last' );\n\n\t\t// Destroy the current instance of the select2 plugin to avoid strange behaivor\n\t\tfieldSelect.find('.wpbb-exercise-selection').select2(\"destroy\");\n\n\t\tvar field = $(this).closest('td').find( '.day_repeat li#day-list-item:last' ).clone( true );\n\n\t\tfield.find('#exercise-list li').remove();\n\n\t\tvar fieldLocation = $(this).closest('td').find('.day_repeat li#day-list-item:last');\n\n\t\t$('.day-header', field).find('h3').html('Day ' + dayNumber, function (index, name) {\n\n\t\t\treturn name.replace(/(\\d+)/, function (fullMatch, n) {\n\n\t\t\t\treturn Number(n) + 1;\n\n\t\t\t});\n\n\t\t});\n\n\t\tfield.insertAfter( fieldLocation, $( this ).closest( 'td' ) );\n\n\t\t// Create new instance of the select2 plugin after the clone is complete\n\t\tmodifySelect();\n\n\t\t//return false;\n\n\t});\n\n\t// Select an exercise for workout\n\tselect.change( function () {\n\n\t\tvar selectedValue = $( this ).val();\n\t\tvar list          = $( this ).parent();\n\n\t\t$( this ).prop( 'selectedIndex', 0 );\n\n\t\taddExercise( selectedValue, list );\n\n\t\t//saveExercises.show();\n\n\t});\n\n\t/**\n\t * saveWorkout\n\t *\n\t * @returns {Array}\n\t */\n\tvar saveWorkout = function() {\n\t\tvar workout = [],\n\t\t\tels     = document.getElementsByClassName( 'day-exercises' );\n\n\t\tfor ( var i = 0; i < els.length; i++ ) {\n\n\t\t\tvar ids          = els[i].getElementsByClassName( 'list' ),\n\t\t\t\texercises    = {},\n\t\t\t\texerciseMeta = [];\n\n\t\t\tfor ( var j = 0; j < ids.length; j++ ) {\n\n\t\t\t\tvar inputs = ids[j].getElementsByTagName( 'input' ),\n\t\t\t\t\tsets = {},\n\t\t\t\t\treps = {},\n\t\t\t\t\trest = {},\n\t\t\t\t\tmeta = {},\n\t\t\t\t\tid   = {};\n\n\t\t\t\tfor ( var k = 0; k < inputs.length; k++ ) {\n\t\t\t\t\tid['id'] = ids[j].dataset.exerciseId;\n\n\t\t\t\t\tif ( inputs[k].id === 'sets' ) {\n\t\t\t\t\t\tmeta['sets'] = inputs[k].value;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( inputs[k].id === 'reps' ) {\n\t\t\t\t\t\tmeta['reps'] = inputs[k].value;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( inputs[k].id === 'rest' ) {\n\t\t\t\t\t\tmeta['rest'] = inputs[k].value;\n\t\t\t\t\t}\n\n\t\t\t\t\texercises['exercise' + j] = exerciseMeta.concat( id, meta );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\texercise = {\n\t\t\t\tday: els[i].getElementsByTagName('h3')[0].textContent,\n\t\t\t\texercises: exercises\n\t\t\t};\n\n\t\t\tworkout.push( exercise );\n\t\t}\n\t\treturn workout;\n\t};\n\n\t// Collect workout days and exercises upon clicking save workout\n\t$( '.save-btn' ).click( function() {\n\n\t\tvar workout             = saveWorkout(),\n\t\t\tnonce               = $( '[name = \"workout_meta_box_nonce\"]' ).val(),\n\t\t\tworkoutId           = $( '[name = \"post_id\"]' ).val(),\n\t\t\tworkoutName         = $( '[name = \"workout_name\"]' ).val(),\n\t\t\tworkoutInstructions = $( '[name = \"workout_instructions\"]' ).val(),\n\t\t\tworkoutCategory     = $( '[name = \"workout_category\"]' ).val(),\n\t\t\tworkoutImage        = $( '[name = \"custom-img-id\"]' ).val(),\n\t\t\tworkoutDuration     = $( '[name = \"workout_duration\"]' ).val(),\n\t\t\tworkoutIntensity    = $( '[name = \"workout_intensity\"]' ).val(),\n\t\t\tworkoutWorkload     = $( '[name = \"workout_workload\"]' ).val(),\n\t\t\tworkoutRest         = $( '[name = \"workout_rest_periods\"]' ).val(),\n\t\t\tworkoutAuthor       = $( '[name = \"workout_author\"]' ).val(),\n\t\t\tworkoutRepetitions  = $( '[name = \"workout_repetitions\"]' ).val(),\n\t\t\tworkoutDescription  = $( '[name = \"workout_description\"]' ).val();\n\n\t\t$.ajax({\n\t\t\ttype: 'POST',\n\t\t\tdataType: 'json',\n\t\t\turl: ajaxurl,\n\t\t\tdata: {\n\t\t\t\taction: 'save_workout_from_post',\n\t\t\t\tworkout: workout,\n\t\t\t\tworkoutId: workoutId,\n\t\t\t\tworkoutName: workoutName,\n\t\t\t\tworkoutCategory: workoutCategory,\n\t\t\t\tworkoutInstructions: workoutInstructions,\n\t\t\t\tworkoutImage: workoutImage,\n\t\t\t\tworkoutDuration: workoutDuration,\n\t\t\t\tnonce: nonce,\n\t\t\t\tworkoutRepetitions: workoutRepetitions,\n\t\t\t\tworkoutAuthor: workoutAuthor,\n\t\t\t\tworkoutRest: workoutRest,\n\t\t\t\tworkoutWorkload: workoutWorkload,\n\t\t\t\tworkoutIntensity: workoutIntensity,\n\t\t\t\tworkoutDescription: workoutDescription\n\t\t\t},\n\t\t\tsuccess: function( response ) {\n\t\t\t\tconsole.log(response.data);\n\t\t\t}\n\t\t});\n\n\t});\n\n\t/**\n\t * Load progress bar on save workout\n\t */\n\tvar save = $( '.save-btn' );\n\n\tfunction move() {\n\t\tvar elem         = document.getElementById(\"progress-bar\"),\n\t\t\twidth       = 20,\n\t\t\tid          = setInterval(frame, 10),\n\t\t\tprogressBar = $( '.progress-background' );\n\n\t\tprogressBar.show();\n\n\t\tfunction hideBar() {\n\t\t\tprogressBar.fadeOut(900);\n\t\t}\n\n\t\tfunction frame() {\n\t\t\tif (width >= 100) {\n\t\t\t\tclearInterval(id);\n\t\t\t\telem.innerHTML = 'Workout Saved!'\n\t\t\t\tsetTimeout( hideBar, 1000 );\n\t\t\t} else {\n\t\t\t\twidth++;\n\t\t\t\telem.style.width = width + '%';\n\t\t\t\telem.innerHTML = width * 1  + '%';\n\t\t\t}\n\t\t}\n\t}\n\n\tsave.on( 'click', function() {\n\t\tmove();\n\t});\n\n});"]}